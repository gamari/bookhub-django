{% extends 'base.html' %}

{% load static %}

{% block title %}
  マイページ
{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/pages/dashboard.css' %}" />
  <link rel="stylesheet" href="{% static 'css/components/contribution.css' %}" />
  <link rel="stylesheet" href="{% static 'css/components/bookshelf.css' %}" />
  <link rel="stylesheet" href="{% static 'css/components/card.css' %}" />
{% endblock %}

{% block content %}
  <div class="page-title">マイページ</div>

  <div class="top-section card">
    <div class="top-left">
      <div class="user-icon"></div>

      <h4>{{ user.username }}</h4>

      <div>
        <div>
          <a class="btn btn-primary" href="{% url 'setting' %}">ユーザー設定</a>
        </div>
      </div>
    </div>

    <div class="top-right">
      <div>
        <h3>{{ month }}月の活動履歴</h3>

        <div class="contribution-calendar">
          <div class="day-label">月</div>
          <div class="day-label">火</div>
          <div class="day-label">水</div>
          <div class="day-label">木</div>
          <div class="day-label">金</div>
          <div class="day-label">土</div>
          <div class="day-label">日</div>

          <!-- 各日のデータを表示 -->
          {% for data in activity_data %}
            <div class="contribution-day" data-count="{{ data.activity_count }}" title="{{ data.date }}: {{ data.activity_count }} activities">{{ data.date.day }}</div>
          {% endfor %}
        </div>
      </div>

      <table class="data-table">
        <tr>
          <th>今月の記録</th>
          <th>数</th>
        </tr>
        <tr>
          <td>メモ数</td>
          <td>20</td>
        </tr>
        <tr>
          <td>読破した書籍数</td>
          <td>5</td>
        </tr>
        <tr>
          <td>レビューした書籍数</td>
          <td>3</td>
        </tr>
      </table>
    </div>
  </div>

  <div class="toolbar-container">
    <div class="toolbar-button">本棚</div>
    <div class="toolbar-button">レビュー一覧</div>
  </div>

  <div class="dashboard-bookshelf-container">
    <div class="dashboard-bookshelf-title mb-4">
      <h2 class="">本棚</h2>
      <a href="{% url 'bookshelf_list' bookshelf.id %}"><i class="fa-solid fa-share"></i></a>
    </div>
    {% if books %}
      <div class="bookshelf">
        {% for book in books %}
          <a href="{% url 'reading_record' book.id %}" class="bookshelf-item"><img src="{{ book.thumbnail }}" alt="{{ book.title }}" /></a>
        {% endfor %}
      </div>
    {% else %}
      <p>本棚には書籍が登録されていません。</p>
    {% endif %}
  </div>
{% endblock %}
