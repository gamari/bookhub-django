{% extends 'base.html' %} 
{% load static %} 

{% block title %} セレクションを作成{% endblock %} 

{% block css %}
<link rel="stylesheet" href="{% static 'css/components/form.css' %}" />
<link rel="stylesheet" href="{% static 'css/components/selection.css' %}" />
{% endblock %} 

{% block js %}
<script src="{% static 'js/pages/create_selection.js' %}"></script>
{% endblock %} 

{% block content %}
<section>
  <h3>セレクションを作成</h3>
  <form method="post" class="form-card max-w-xl">
    {% csrf_token %}

    <div class="form-group">
      <label for="id_title">タイトル</label>
      {{ form.title }}
    </div>

    <div class="form-group">
      <label for="id_description">説明</label>
      {{ form.description }}
    </div>

    <div class="form-group">
      <label for="">
        <span>書籍</span>
        <span class="label-help">(本棚から選択します)</span>
      </label>
    </div>

    {% comment %} TODO 検索機能を作りたい {% endcomment %}

    <div class="selection-list" style="display: flex">
      {% for book in form.books.field.queryset %}
      <div class="book-selection selection-panel">
        <img
          src="{{ book.thumbnail }}"
          alt="{{ book.title }}"
          class="book-image book-image-md"
        />
        <input
          type="checkbox"
          name="{{ form.books.name }}"
          value="{{ book.id }}"
          style="display: none"
        />
      </div>
      {% empty %}
      <div class="p-4 border bg-info">
        <p>本棚に書籍を追加してください</p>
      </div>
      {% endfor %}
    </div>

    <button type="submit" class="mt-4 btn btn-primary">
      作成<span id="selected-count"></span>
    </button>

    {% if error_message %}
    <p class="mt-4 form-error">{{ error_message }}</p>
    {% endif %}
  </form>
</section>
{% endblock %}
